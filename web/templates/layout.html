<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>BountyBoard üè¥‚Äç‚ò†Ô∏è</title>
    <link rel="stylesheet" href="/static/css/style.css"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <script src="/static/js/main.js" defer></script>
</head>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const modals = document.querySelectorAll('.modal');
        const openButtons = document.querySelectorAll('.btn-desc');
        const closeButtons = document.querySelectorAll('.close');

        // === üìú –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ ===
        openButtons.forEach((btn, idx) => {
            btn.addEventListener('click', () => {
                modals[idx].classList.add('show');
            });
        });

        // ‚ùå –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–Ω–æ–ø–∫–µ
        closeButtons.forEach((btn, idx) => {
            btn.addEventListener('click', () => {
                modals[idx].classList.remove('show');
            });
        });

        // ‚ùå –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
        window.addEventListener('click', (e) => {
            modals.forEach(modal => {
                if (e.target === modal) modal.classList.remove('show');
            });
        });

        // === üí∞ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ ===
        document.querySelectorAll(".btn-complete").forEach((btn) => {
            btn.addEventListener("click", async () => {
                const taskItem = btn.closest(".task-item");
                const taskId = taskItem.dataset.id || "unknown";

                // ‚úÖ AJAX-–∑–∞–ø—Ä–æ—Å
                try {
                    await fetch("/complete-task", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ id: taskId }),
                    });
                } catch (err) {
                    console.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:", err);
                }

                // üí• –≠—Ñ—Ñ–µ–∫—Ç—ã
                taskItem.classList.add("done");

                for (let i = 0; i < 16; i++) {
                    createCoin(taskItem);
                }

                // setTimeout(() => taskItem.remove(), 1000);
            });
        });

        // üéâ –ú–æ–Ω–µ—Ç–∫–∞
        function createCoin(parent) {
            const coin = document.createElement("div");
            coin.classList.add("coin-burst");

            const rect = parent.getBoundingClientRect();
            const x = Math.random() * rect.width;
            const y = Math.random() * rect.height;

            coin.style.left = `${x}px`;
            coin.style.top = `${y}px`;

            parent.appendChild(coin);
            setTimeout(() => coin.remove(), 1200);
        }
    });
</script>



<body>
<div class="rope rope-left"></div>
<div class="rope rope-right"></div>

<header>
    <h1><span class="emoji">üè¥‚Äç‚ò†Ô∏è</span>BountyBoard</h1>
    <p class="subtitle">Track your tasks like a true pirate!</p>
</header>

<main>
    {{ block "content" . }}{{ end }}
</main>

<footer>
    <p>Made with rum and Go ü¶ú</p>
</footer>
</body>
</html>
